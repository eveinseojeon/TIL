# Clustering

: 비지도학습 중 한 가지 알고리즘

비지도학습의 차원축소법은 데이터의 특성 변수를 압축하는 방법(열을 압축), 군집 분석은 case, 관찰치 등 사례들을 압축하는 방법(행을 압축. 변형해서 새로운 걸 마들어낸다기보다 행들을 비슷한 것들끼리 묶어서 몇 개의 덩어리로 split하는 것)



군집분석이란?

: 라벨이 없는 상태로, k개의 특성 변수들만을 이용해서 observation(관측치)들을 유사한 것들끼리 몇 개의 덩어리(군집)로 쪼개는 것. 유사하다는 것의 정의는 특성 변수의 값이 비슷한가를 기준으로 판단한다.

어떤 개체나 대상들을 밀접한 유사성(similarity) 또는 비유사성(dissimilarity)에 의하여 유사한 특성을 지닌 개체들을 몇 개의 군집으로 집단화하는 비지도학습법.

각 군집의 특성, 군집간의 차이 등에 대한 탐색 대상으로, 집단에 대한 심화된 이해가 목적.

특이 군집의 발견, 결측값의 보정(군집화해서 결측값이 포함된 군집의 평균값으로 결측값을 예측) 등에도 사용될 수 있다.



유사한 것끼리 군집화를 한다.

군집 내 동질성, 군집 외 이질성



## 계층적 군집 분석 (Hierarchical clustering)

병합적(agglomerative) vs 분할적(divisive)

- 병합적 : 개체 간 거리가 가까운 개체끼리 차례로 묶어주는 방법으로 군집을 정의
- 분할적 : 개체 간 거리가 먼 개체끼리 나누어가는 방법으로 군집을 정의



계층적 군집 분석에서는 병합적 방법이 주로 사용된다.



개체 간 거리

- 유클리디안 거리
- 맨해튼 거리
- 민코우스키 거리



군집 간 거리

- 단일연결법 (최단연결법, single linkage)

​	: 두 군집의 모든 개체 간 거리들 중 최솟값(min)

- 완전연결법 (최장연결법, complete linkage)

​	: 두 군집의 모든 개체 간 거리들 중 최댓값(max)

- 평균연결법 (average linkage)

​	: 두 군집의 모든 개체 간 거리들의 평균 = 거리들의 평균

- 중심연결법 (centroid linkage)

​	: 두 군집의 중심 사이의 거리 = 평균들의 거리

- 와드연결법 (ward linkage)

​	: SSE를 군집의 중심으로부터 해당 군집의 각 개체간의 거리 제곱 합으로 정의 -> 2개 군집을 하나의 군집으로 묶었을 때 SSE가 증가하는 정도를 두 군집 간의 거리로 정의. 즉, SSE(pooled) - (SSE1 + SSE2). 이 증가한 정도가 크면 두 군집이 멀리 떨어져 있다고 정의. 계산량이 좀 많긴 하지만 변동성을 이용해서 군집 간의 거리를 정의하는 것으로서 많이 활용되는 방법임.



개체와 군집 간 거리는 개체를 군집이라 생각하고 군집 간 거리를 적용하면 된다.





덴드로그램 (Dendrogram)

: 군집분석의 결과를 시각화한 것

군집 간 거리가 멀고, 군집 내 거리가 가까워지도록 적절한 지점에서 절단하여 군집 수를 결정한다.



계층적 군집분석의 덴드로그램 툴을 사용하면 군집의 개수를 정의하거나 군집의 형태를 묘사, 탐색하기에 도움이 되기 때문에, 최종적으로 다른 군집분석으로 군집화를 하더라도 군집의 형태를 파악하기 위해 계층접 군집분석을 보조적인 수단으로 함께 사용하는 경우가 많음.

다만 계산량이 많아서 시간이 오래 걸린다는 단점이 있다. 그럴 때는 데이터가 너무 많으면 랜덤하게 일부 뽑아서 계층적 군집분석을 돌려봐서 군집의 개수를 정의하거나 군집의 형태, 패턴 등을 먼저 탐색하는 용도로 활용하기도 한다.



덴드로그램이 주어지면 어디에서 자를지 결정

-> 군집의 수가 달라짐.



## 비계층적 군집 분석 (K-means clustering)

: 계층적 군집 분석의 대안이 될 수 있음

데이터의 용량이 크고, 빠른 계산을 원할 때 k-means clustering을 사용하면 됨



K-평균 군집분석

: 군집을 몇 개로 할지, 사전에 적절한 k를 먼저 정해야 함.

계산량이 적어서 대용량 데이터를 빠르게 처리 가능.

초기의 군집 중심이 지정되는 위치에 따라 최종 결과가 영향을 많이 받음. (가능한 한 초기군집 중심 간의 거리가 먼 것이 좋다.)

잡음이나 이상치의 영향을 많이 받음.(각 군집 중심점에 영향을 주기 때문에.)



k-평균 군집분석의 알고리즘

- 개체를 k개의 초기 군집으로 나눈다. (초기 군집에 결과가 영향을 받기 때문에 초기 군집을 바꿔서 여러 번 수행해보는 것이 바람직하다.)
- 각 군집의 중심(centroid)을 계산한 뒤 모든 개체들을 각 군집의 중심에 가장 가까운 군집에 할당시킨다.
- 새로운 개체를 받아들이거나 잃은 군집의 중심을 다시 계산한다.
- 위 과정을 더 이상의 재배치가 생기지 않을 때까지 반복한다.





k-평균 군집분석에서 적절한 군집 수 k의 결정

\- 오차제곱합(SSE: sum of squared error)

: 각 군집 내 개체들과 해당 군집 중심점과의 거리를 제곱한 값들의 합

오차제곱합이 작을수록 군집 내 유사성이 높아 잘 응집된 것.

군집 수 k에 따른 SSE의 변화를 Elbow 차트로 시각화한 뒤, SSE가 급격히 감소하다가 완만해지기 시작하는 시점의 k를 적정 군집 수로 판단한다.

꺾이는 지점이 최적의 군집 수라고 판단하는 것.

적은 수의 군집으로 작은 SSE를 달성하는 것이 목표이므로.



내가 선정한 군집 수가 적절한가, 이보다 나은 값은 없는가?


