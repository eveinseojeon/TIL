## 통계적 추론 개요, 표본추출법

모수: 모집단의 특성치

통계량: 표본의 특성치



표본평균 분포의 평균 = 모평균

표본평균 분포의 분산 = 모분산/n

표본평균이 많아지면(n이 커지면) 분산이 줄어 분포 뾰족해짐



표본추출법

- 단순임의 추출법 (SRS: simple random sampling)
- 계통 추출법 (systematic sampling) : 자료가 사이클을 갖는 구조라면 편향이 생김
- 집락 추출법 (cluster sampling) : 분할된 각 집락이 이미 모집단을 잘 반영하도록 섞여있음
- 층화 추출법 (stratified sampling) : 모집단에서 이질적인 특성을 감안해서 그 특성끼리 묶여 분할되어 있음. 그래서 각 층에서 표본을 추출



표본추출법에 따라 분석 결과 및 해석에 큰 차이가 발생



## 점추정과 구간추정

추정: 모수를 맞추는 문제



추정량: 통계량 중에 모수의 추정이 목적인 것들

^을 붙이면 관심 모수를 맞추려고 만든 추정량이라는 뜻

통계량에 대응되는 개념이라 랜덤



추정치: 관찰된 값으로 계산한 결과, 요약치



점추정

: 하나의 모수를 한 개의 값으로 추정



구간추정

: 모수가 포함되리라 기대되는 구간으로 모수를 추정

통계량이 갖는 표본분포를 알아야 함



신뢰수준이 높을수록 구간이 모수를 포함할 가능성이 높아짐 -> 좋은 추정



신뢰수준

: 동일한 구간 추정법을 반복적으로 사용할 때 얻어지는 신뢰구간들이 참값 theta를 품을 확률을 의미함

즉, 구간이 모수(참값: theta)를 포함할 확률



n개의 표본으로 구한 신뢰구간 추정치는 반복할 수 없다. 한 번만 관찰을 한다. 여러번 할 수 없다.

이 구간이 모수를 포함할 가능성이 몇 % 되도록 디자인되어있는 구간 추정량을 활용하는 것.

모수는 가만히 있고 구간이 움직임

반복해서 만들어지는 구간은 조금씩 다른데 내가 만든 구간이 모수를 포함할 가능성이 이만큼 되도록 만들었다.



## 가설 검정의 원리

가설 검정

통계적 추론 중 대표적인 방법

표본의 정보를 활용하여 모집단에 대한 가설의 합당성 여부를 판정하는 과정



가설 검정의 절차

: 가설설정 -> 검정 통계량 -> 기각역 or 유의확률 -> 두 상반되는 가설 중 어느 쪽이 맞는지 결론 제시



통계적 가설검정이란?

표본으로부터 주어지는 정보를 이용하여, 모수에 대한 예상, 주장, 또는 추측 등의 옳고 그름을 판정하는 과정



귀무가설 H0 (H null) : Default. 현재까지 사실로 받아들여지는 가설

귀무가설은 항상 등호(=)를 쓴다.



대립가설 H1 (H a) : 표본자료로부터의 강력한 증거에 의해 입증하고자 하는 가설

대립가설은 부등호(<, >) 또는 같지 않다(!=)를 쓴다.



표본의 정보가 귀무가설에 대한 충분한 반증이 된다.

-> 귀무가설 기각-> 대립가설이 맞다



하나의 모수를 추정하는 가설검정 문제에서는 그 모수에 대한 추정량을 이용해서 가설 검정을 할 수 있고,

또한 이때 추정량의 분포도 알려져 있어야 한다.



점추정, 구간추정 등 통계량을 모수를 추정하는 데 쓰면 추정량이 되고,

통계량을 검정에 활용하면 검정통계량이라 부른다.

귀무, 가설 중 어느 하나를 택하는 기준을 결정하는 통계량 = 검정통계량



귀무가설 기각여부를 판단하기 위한 2가지 접근 방식

- 기각역
- 유의확률



기각역: 기각한다는 결정을 내리게 하는 검정통계량의 영역

이 영역을 찾고 우리가 관찰한 결과가 이 영역에 들어가는가



둘 중 유의확률에 의한 검정이 우리에게 더 제공해주는 정보가 많다.

이 분포에서 귀무가설 하에서 나온 걸로 보기에 얼마나 희박한가? 확률



귀무가설 하에서 충분히 이 값이 나올 만하다 하면 기각 못함



유의확률(p-value)

귀무가설 H0이 사실일 때 검정통계량의 분포에서, 대립가설 H1의 방향(작다 - 왼꼬리, 크다-오른꼬리, 같지않다 - 양쪽꼬리)으로, 검정통계량의 관찰값보다 더 극단적인 값이 나올 확률로 계산된다.

그 확률이 크면 귀무가설 하에서 나올 만한 것이고,

그 확률이 낮으면 귀무가설 하에서 나오기 희박한 것 -> 귀무가설 반증 -> 대립가설 지지 -> 귀무가설 기각



유의확률이 아주 작으면 대립가설을 지지

얼마나 작아야 하나?



‘검정의 오류’ 개념

제1종 오류: 귀무가설 H0이 사실인데 귀무가설 기각 = 알파

제2종 오류: 대립가설 H1이 사실인데 귀무가설 기각X = 베타



이 두 종류의 오류는 서로 상충관계라 동시에 줄이기 어렵다.

더 위험한 제1종 오류를 일정수준을 넘지 못하도록 제한하면서, 제2종 오류를 최소화하는 검정법을 찾고자 함



유의수준: 제1종 오류를 범할 확률의 최대 허용 한계!



유의확률(p-value) < 유의수준이면 귀무가설 H0을 기각



IID(independent and identically distribution) 표본???





## 모평균에 관한 가설검정(one sample t test)

모집단이 정규분포고 모분산이 알려진 경우에는 표준정규분포 Z로 변환해서 계산하면 됨.



그런데 일반적으로는 모분산이 안 알려져 있음.

모집단이 정규분포를 따를 때 분산이 알려지지 않은 경우에는?



그때 사용할 수 있는, 모분산을 모를 때 모평균에 관한 가설검정

일표본 t검정

t-분포(자유도: n-1)

T ~ t(n-1)



뮤에 관한 귀무가설, 대립가설에 대한 검정을 한다.

표본평균의 표본분포가 필요하다



시그마를 s로 대체.

자유도 n-1인 T분포를 따르게 됨.



## 모평균 비교에 관한 가설검정(independent two sample t test)

독립 2표본 t-검정

둘 다 정규분포

독립인 두 그룹의 모평균 비교

등분산(두 모집단의 분산이 같다) 가정할 수 있다면

두 그룹의 변동성은 일정한데 평균의 차이가 있을까?



-> 즉, 정규, 등분산, 독립의 가정이 필요.



 상수값 theta = 뮤1 - 뮤2



표본평균의 차이로 모평균의 차이에 대한 추론을 한다.

추정량의 표본분포가 필요하다.

t-분포를 사용할 것.



모분산에 관한 정보를 모르므로,

각 그룹별 표본분산을 가중평균한 합동분산추정량 Sp제곱을 이용

이것으로 모분산을 대체하는 방법으로 검정통계량 정의



등분산이 가정되지 못하고 이분산이면

Welch’s t-test





## 모평균 비교에 관한 가설검정(paired t test)

쌍체 t검정 (paired t-test)

대응비교

두 모집단의 평균 비교



독립 이표본 t-검정의 경우는 두 그룹에서 추출된 표본들이 서로 완전히 무관한 독립의 상태라 가정



쌍체 t-검정의 경우는 두 그룹에서 관찰한 표본들이 서로 짝지어져 있는 상태



짝을 만드는 원리, 독립 이표본 t검정과의 차이점 등을 알아야 한다.



대응표본?

어떤 요인(방해요인)이 자료에 주는 영향을 통제하여

평균 차이를 더 효과적으로 볼 수 있음

방해요인의 값이 비슷하도록 짝을 묶어서 비교



총 n쌍의 자료를 사용



평균에 관한 추론을 하는데 자료 내에서 변동성이 크면 평균 추론에 부정적 영향을 미친다.

실제로는 대립가설이 사실이라 귀무가설을 기각해야 하는데 기각하지 못하는 상황 - 검정력이 떨어지는 검정



변동성을 줄이면 효과적 검정을 할 수 있다.

그 방법이 대응표본을 이용하는 것

방해요인이 비슷한 둘씩 짝짓는 것

그렇게 해서 차이를 구하면 변동성이 작아지는 표본이 됨.

-> 효과적 검정 가능



독립적으로 추출한 경우 대비 표본정보의 변동성이 줄어들어 검정력 높은 검정 가능!



그 차이인 d값들이 정규분포를 따른다는 가정이 필요.

차이들의 분산, 모분산 알려져있지 X



같은 한 명에 대해 두 번 실험해서 결과를 얻어서 비교하는 건

쌍체검정용 자료, 대응 표본을 만들기 위해서이다.



## 모평균 비교에 관한 가설검정(One way ANOVA 및 사후검정)

분산분석

여러 그룹의 평균 비교 시

어떤 요인(factor)이 반응 변수에 영향이 있을까?에 대한 검정



요인(factor): 모집단(그룹)의 구분 기준

처리(treatment (levels)): 요인을 구성하는 각 모집단(그룹)

반응 변수: 어떤 대상을 관찰하는가



모평균 비교에 관한 가설 검정

둘 이상의 모집단에 대해 평균 비교를 하는 문제에 적절한 검정 방법



이름은 분산분석이지만, 사실 평균 비교에 관한 검정

ANOVA 검정 후 어떤 모평균의 차이가 있는지 사후검정까지



평균 차이를 파악하기 위해 변동성 정보를 이용.

그룹 별 평균이 따르면 그룹 별 변동성이 클 것이므로?



각각의 그룹별 표본을 뽑고 그 평균을 구한다

그것들의 변동성을 구해서

변동성이 크면 -> 모평균이 모두 같은 것은 아니다

변동성이 작다 (표본 평균들이 서로 비슷하다) -> 모평균은 모두 같다



일원배치 분산분석(one-way ANOVA:analysis of variance)

: 1개의 요인에 대해 k개의 처리(그룹)로 분류되어 있는 자료



각 처리들의 평균과, 전체 평균도 필요함.



정규, 등분산(그룹별 평균은 다르지만 분산은 모두 동일하다), 독립의 가정이 필요.

-> one-way ANOVA 방식, 나중에 F검정까지 가능



반복수: 그룹별로 표본을 몇 개 관찰했는가

반복수 달라도 상관 없다.



총제곱합(SST: sum of squares total)

: 총 변동성.

처리 구분하지 않고 전체를 하나의 그룹으로 보고 자료가 갖는 변동성.

전체 평균으로부터 각각이 얼마나 떨어져있는지



오차제곱합(SSE: sum of squares error)

: 그룹 내 변동.

각각 그룹 내 자료들이 자신들의 평균으로부터의 차이의 제곱 합



요인제곱합(SSTR: sum of squares treatment)

: 그룹 간 변동.

k개의 각 그룹의 평균들이 전체 평균으로부터 얼마나 떨어져있는지



SSTR(그룹 별 평균의 변동, 요인에 의한 변동, 그룹 간 변동)의 크기로 집단 간 모평균의 차이를 알 수 있다!

SSTR이 작으면 뮤1부터 뮤k는 모두 같다고 말할 수 있다.

SSTR이 크면 모평균들은 모두 같지 않다. -> 귀무가설 기각



그렇다면 SSTR은 얼마나 커야 하는가?

SSE와의 상대적 크기를 감안해야 한다.



그룹 간 모평균 차이를 파악하기 위해서는 SSE(그룹 내 변동)에 비해 SSTR(그룹 간 변동)의 상대적 크기를 측정해야 한다.

그룹 내 변동에 비해 그룹 간 변동이 얼마나 큰가?



귀무가설 H0: 집단 간 평균의 차이가 없다. 즉, 뮤1 = 뮤2 = … = 뮤k

대립가설 H1: 집단 간 평균의 차이가 존재한다. 해당 요인의 처리 효과가 있다. 즉, 모두 같은 것은 아니다.



우리가 알고자 하는 건 SSTR이 큰가?이다.

SSTR이 크면 모평균은 모두 같지 않다. -> 귀무가설 기각

얼마나 커야 하는가? SSTR의 크기는 SSE에 의존한다.

상대적인 크기를 봐야 한다.



MSE = SSE / (nk-k)

MSTR = SSTR / (k-1)



이 둘의 상대적 크기를 비교하면 모평균의 차이를 볼 수 있다.



모평균이 모두 같으면 MSTR, MSE 비슷

모평균이 모두 같지 않으면 MSTR > MSE



MSTR/MSE(그룹 내에 비한 그룹 간 변동)를 검정 통계량으로 잡는다.

F 분포를 따른다.



대립가설의 방향이 항상 오른쪽이다.

즉, 검정 통계량의 관찰값보다 큰 값이 나올 확률을 구하면 그게 p-value

p-value가 유의수준보다 작으면 귀무가설 기각!



ANOVA 결과 귀무가설을 기각하게 되면,

모평균이 모두 같지는 않다는 건데,

어떤 평균이 어떻게 다른지 파악하기 위해서 

사후검정

다양한 사후 검정법이 있다.

Fisher의 LSD 방식, Tukey의 W 방식, Duncan의 Multiple Range Test, Scheffe의 S 방법, Dunnett의 방식 등…



Fisher의 LSD 방식

둘씩 짝지어서 뮤1과 뮤2, 뮤1과 뮤3, 뮤2와 뮤3 이렇게 세 번 검정을 한다.

어디서 모평균 차이가 났는가?

다중비교

각각 모집단의 평균차이 t검정을 반복수행하는 것.



## 모평균 비교에 관한 가설검정(Two way ANOVA)

이원배치 분산분석(Two-way ANOVA)

2개의 factor로 그룹들이 나눠졌을 때 각 그룹별 평균 비교

각각의 factor별로 미치는 효과,

두 개의 factor에 대한 상호작용 효과를 검정



요인설계

반응변수에 영향을 미치는 요인의 수가 여러 개인 경우, 요인설계를 적용해야 함



가장 단순한 요인설계 분석법

요인이 2개, 각 요인 별 처리 수준이 2개 이상인 경우

주 효과: 각 요인 별 처리 수준 간의 모평균 차이에 관한 분석

상호작용 효과: 두 요인 간 상호작용에 관한 분석



2개 주 효과는 일원배치분산분석 두 번 돌린 것과 같음



treatment들의 조합들이 만들어내는 상호작용 효과 또한 검정할 수 있다.

시너지 같은 효과가 존재하는가

어떤 factor의 treatment를 뭘 선택하느냐에 따라, 다른 factor의 treatment 효과의 양상이 달라지면 상호작용 효과가 존재한다고 한다.



처리 그룹 간 변동, 그리고 상호작용에 의한 변동이

그룹 내 변동(SSE)에 비해, 상대적으로 얼마나 큰가?



완전 확률화 과정: 완전 무작위 배치



가정: 정규, 등분산, 독립



항상 오른쪽 꼬리 검정



## 모분산 비교에 관한 가설검정(F-test of equality of variances)

정규분포를 따르는, 비교하고자 하는 모집단 두 개가 있을 때

두 모분산을 비교하는 검정



검정통계량 theta^ = (s1의제곱 / s2의제곱) ~ F[n1-1, n2-1]

추정량을 비율로 하여 1보다 큰지 작은지



각 모집단에서 다른 개수의 n1, n2개의 표본을 각각 추출한다.



모분산 비교 F검정

시그마1을 기준으로 두고, 왼 꼬리, 오른 꼬리, 양쪽 꼬리 검정을 한다.



모집단이 둘 이상인 경우에 등분산 검정

여러 모집단의 모분산 비교



귀무가설 H0: k개의 모든 모분산이 같다

대립가설 H1: 적어도 하나 이상의 모분산은 나머지와 다르다



- Barlett 검정

모집단이 모두 정규분포를 따르는 경우 적용

k=2면 등분산 F검정, k>3부터는 Bartlett의 검정 사용



- Levene 검정

모집단에 대한 정규성 가정이 주어지지 않은 경우 적용



두 검정 모두

검정 결과 p-value가 유의수준보다 작으면 귀무가설 기각, 즉 적어도 하나 이상의 모분산은 나머지와 다르다.



T검정: 한 모집단의 평균 비교 검정

F검정: 두 모집단이 정규분포를 따를 때 모분산 비교 검정



## 범주형 변수 간의 독립성검정(Chi-squared test)

범주형 자료 분석은 크게 적합도 검정, 독립성 검정으로 나누어진다.

- 적합도 검정: 하나의 범주형 변수에 대해 각 범주별 확률에 관한 검정
- 독립성 검정: 서로 다른 두 범주형 변수 간에 연관성이 있는지를 검정

한 범주형 변수가 다른 범주형 변수와 연관이 있을까, 서로 무관한가?



2차원 분할표

: 2개의 범주형 변수를 요약하는 r*c의 2차원 분할표



기대빈도

:만약 두 변수가 독립이라면 어떤 빈도가 관찰될 것으로 기대된다.



자료로부터 구해진 빈도와, 기대빈도가 각 셀별로 짝지어서 봤을 때 비슷하다면 두 변수가 독립이라는 주장을 지지.



자료로부터 구해진 빈도와 기대빈도가 상당히 달라진다면 독립이 아니다, 즉 연관이 있다.



귀무가설 H0: 두 범주형 변수는 서로 독립이다(관계가 없다)

독립가설 H1: 두 범주형 변수는 독립적인 관계가 아니다(관계가 있다)



표본의 수가 충분히 큰 경우(모든 셀별로 기대빈도가 5 이상)

검정통계량 값들은 자유도 (r-1)(c-1)의 카이제곱 분포를 따른다.



대립가설의 방향이 오른쪽 방향이다

오른꼬리 검정



- 두 범주형 변수의 연관성 파악!
- 모분포에 대한 가정 없이, 표본수가 충분히 크면 적용 가능
- 두 범주형 변수가 독립이라는 것이 귀무가설
- 항상 오른꼬리 검정
